---
title: "Castanha"
author: "Fernando Lima, D.Sc."
output: html_notebook
---

```{r packages, include=FALSE}
library(here)
library(dplyr)
```

```{r dataReading}
producaoCazumba = read.csv(here("data", "producao.csv"), sep = ";")
sementesCazumba = read.csv(here("data", "sementes.csv"), sep = ";")
```

```{r limpeza}
producaoCazumba$Castanhal <- gsub("Zirmão","Zirmao",producaoCazumba$Castanhal)
producaoCazumba$Castanhal <- gsub("Irmãos","Irmaos",producaoCazumba$Castanhal)

unique(producaoCazumba$n_frutos_ouricos_produzidos)
```

```{r agregandoDados}

sementesSoma=group_by(sementesCazumba,Castanhal,Ano)

sementesAgregada = summarise(
    sementesSoma,
    total_sementes = sum(
        n_de_sementes_por_fruto_ourico,
        na.rm = TRUE
    ),
    media_sementes = mean(
        n_de_sementes_por_fruto_ourico,
        na.rm = TRUE
    ),
    peso_total = sum(
        Peso_total_das_sementes_dos_10.frutos_ouricos_Kg,
        na.rm = TRUE
    ),
    peso_semente=  peso_total/total_sementes
)

producaoSoma = group_by(producaoCazumba, Castanhal,Ano )

producaoAgregada = summarise(
    producaoSoma,
    total_frutos = sum(
        n_frutos_ouricos_produzidos,
        na.rm = TRUE
    )
)
```

```{r exportando}
sementesAgregada = as.data.frame(sementesAgregada)
producaoAgregada = as.data.frame(producaoAgregada)
write.csv(sementesAgregada, here("output", "sementesAgregadas.csv"))
write.csv(producaoAgregada, here("output", "producaoAgregada.csv"))
```

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code.

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*.

```{r}
par(mar=c(7,5,5,5))
barplot(
    sementesAgregada$media_sementes[which(sementesAgregada$Ano=="2018")]~sementesAgregada$Castanhal[which(sementesAgregada$Ano=="2018")],
    las=2,
    col="blue",
    xlab="",
    ylab="Média de Sementes",
    main = "Produção Média de sementes",
    ylim=c(0,25)
)

barplot(
    sementesAgregada$media_sementes[which(sementesAgregada$Ano=="2019")]~sementesAgregada$Castanhal[which(sementesAgregada$Ano=="2019")],
    las=2,
    add=T,
    col="red")

legend("topright", fill = c("darkblue", "red"), legend=c("2018", "2019"))

```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.
