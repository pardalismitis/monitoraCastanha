---
title: "Monitoramento Participativo da Biodiversidade"
author: "Fernando Lima, D.Sc."
output:
  word_document: default
  html_document:
    df_print: paged 
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code.

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*.

```{r packages, include=FALSE}
rm(list = ls(all = TRUE))
#install.packages("here")
#install.packages("tidyverse")
#install.packages("ggplot2")
#install.packages("vctrs")
#library(tidyverse)
library(ggplot2)
library(here)
library(vctrs)
```

-   Subprograma Terrestre

    -   Componente Florestal

        -   Alvo Complementar: Castanha da Amazônia

            -   Protocolo Básico

Os dados, scripts e informações aqui contidas estão disponíveis no GitHub no endereço: <https://github.com/pardalismitis/monitora-mpb>

```{r dataReading, include=FALSE}
ID = 
  read.csv(here("data", "id.csv"),
           encoding = "UTF-8"
           )

totalColetado = 
  read.csv(here("data", "formulario2a.csv"),
           sep = ";",
           na.strings = c("", "NA"),
           encoding = "UTF-8"
           )

manejo = 
  read.csv(here("data", "formulario2bManejo.csv"),
           na.strings = c("", "NA"),
           encoding = "UTF-8"
           )

governanca = 
  read.csv(here("data", "formulario3Governanca.csv"),
           na.strings = c("", "NA"),
           encoding = "UTF-8"
           )

custo = 
  read.csv(here("data", "formulario4Custo.csv"),
           na.strings = c("", "NA"),
           encoding = "UTF-8"
           )

comercializacao = 
  read.csv(here("data", "formulario5Comercializacao.csv"),
           na.strings = c("", "NA"),
           encoding = "UTF-8"
           )
```

LIMPEZA DE DADOS

```{r limpeza, include=FALSE}
AccChars <- "ŠŽšžŸÀÁÂÃÄÅÇÈÉÊËÌÍÎÏÐÑÒÓÔÕÖÙÚÛÜÝàáâãäåçèéêëìíîïðñòóôõöùúûüýÿ "
RegChars <- "SZszYAAAAAACEEEEIIIIDNOOOOOUUUUYaaaaaaceeeeiiiidnooooouuuuyy_"

for(i in 1:ncol(totalColetado)) {       
  totalColetado[ , i] <- chartr(AccChars, RegChars, totalColetado[ , i])
  totalColetado[ , i] <- tolower(totalColetado[ , i])
  for(i in 1:ncol(ID)) {       
  ID[ , i] <- chartr(AccChars, RegChars, ID[ , i])
  ID[ , i] <- tolower(ID[ , i])
}
}

totalColetado$UC <- gsub("cautario","Cautário",
                                gsub("lago_cunia","Lago Cunião",
  #                              gsub("2_irm‹os","2_irmaos",
   #                             gsub("Araœjo","Araujo",
                                     totalColetado$UC))


```

CARACTERÍSTICAS - FORMULÁRIO 1A

```{r numeroDeCastanhais}
ggplot(
  ID, aes(x = UC))+
  geom_bar(stat = "count", fill = "blue")+
  labs(y = "NÚMERO DE CASTANHAIS AVALIADOS")
```

PORCENTAGEM DE CASTANHAIS COLETADOS

NADA A VER COM NADA:

counts=table(ID\$UC) counts=prop.table(counts,1)\*100 barplot(counts, cex.lab=1.5, cex.main=1.5,main="Proporção de Castanhais coletados", xlab="Unidades de Conservação", col=c("Black"), legend = c("Coletados"), ylab="Porcentagem", ylim = c(0,100))

## DEMOGRAFIA NAS SAFRAS - FORMULÁRIO 2A

### NÚMERO MÉDIO DE PESSOAS POR CASTANHAL EM CADA UNIDADE DE CONSERVAÇÃO
```{r}
defaultW <- getOption("warn")
options(warn = -1)
#options(warn = defaultW)

ggplot(
  totalColetado, aes(
    #fill = UC,
    y = as.integer(N_pessoas),
    x = UC)
  )+
  geom_bar(stat = "identity", fill = "blue")+
  #facet_wrap(~UC) +
  labs(y = "NÚMERO DE PESSOAS")
```

### VARIAÇÃO DO TOTAL COLETADO EM CADA UC

par(mfrow=c(1, 1)) par(mar=c(5,5,5,5)) plot(TC$KG_TOTAL~ID$UC,cex.lab=1.5, ylim=c(0,7000),ylab = "Quantidade de Castanha (KG)", xlab = "Unidade de Conservação") par(mar=c(5,5,5,5)) barplot(TC$KG_TOTAL~ID$ID,cex.lab=1.5, ylim=c(0,7000),ylab="Quantidade coletada em cada castanhal", xlab="Castanhais") text(4,6800, "Cautario") text(18,6800, "Rio Ouro") text(18,6000, "Preto") text(28,6800, "Cuinã") text(41,6800, "Cazumbá") abline(v=12.4) abline(v=23.8) abline(v=34.8)

```{r}

```


par(mfrow=c(1, 1)) \### Presenca de arvores nao coletadas counts=table(TC$Arvo_nao_coletada,ID$UC) counts=prop.table(counts,2)\*100 barplot(counts, cex.lab=1.5, cex.main=1.5,main="Presenca de árvores não coletadas", xlab="Unidades de Conservação", col=c("Black","Gray"), legend = rownames(counts), ylab="Porcentagem", ylim = c(0,100))

###Principais razões por parar de coletar counts \<- table(TC\$Arvo_nao_coletada_porque) barplot(counts, cex.lab=1.5, cex.main=1.5,main="Razões para não coletar", xlab="Razões", ylab="Frequencia" )

### Busca de novas árvores

counts=table(TC$Arvo_Nova_Colet,ID$UC) counts=prop.table(counts,2)\*100 barplot(counts, cex.lab=1.5, cex.main=1.5,main="Há novas árvores?", xlab="Unidades de Conservação", col=c("Black","Gray"), legend = rownames(counts), ylab="Porcetagem", ylim = c(0,100))

###Media de novas árvores boxplot(TC$Arvo_Nova_Colet_quant~ID$UC, cex.lab=1.5, cex.main=1.5,ylab = "Quantidade", main="Árvores novas", xlab = "Unidade de Conservação")

############################### 

######## MANEJO -formulario 2B

############################## 

par(mfrow=c(1, 1)) \### Número de dias coletando plot(Manejo$N_dias_cole~ID$UC, cex.lab=1.5, ylab = "Dias coletando", xlab = "Unidade de Conservação")

####Manejo par(mfrow=c(1, 3)) par(mar=c(7,5,5,5)) ##Cipo counts=table(Manejo$Cort_cipo,ID$UC) counts=prop.table(counts,2)*100 barplot(counts, main="Há manejo de Cipó?", cex.main=1.5, col=c("Black","Gray"), legend = rownames(counts), las=2, ylim = c(0,100)) ##Limpeza counts=table(Manejo*$Limpeza_vege,ID$UC) counts=prop.table(counts,2)100 barplot(counts, main="Há Limpeza da Vegetação?", col=c("Black","Gray"),las=2, legend = rownames(counts), cex.main=1.5,ylim = c(0,100)) #Queima counts=table(Manejo$Queima_vegetacao,ID$UC) counts=prop.table(counts,2)*100 barplot(counts, main="Há queima da Vegatação?", las=2, col=c("Black","Gray"), legend = rownames(counts),cex.main=1.5, ylim = c(0,100)) par(mfrow=c(1, 1)) #Sangrou counts=table(Manejo*$Sangrou,ID$UC) counts=prop.table(counts,2)100 barplot(counts, main="Sangrou?", xlab="Unidades de Conservação", col=c("Black","Gray"), legend = rownames(counts), ylim = c(0,100), ylab="Porcentagem")

## Inicio do sangramento

par(mfrow=c(1, 1)) dat_cautario \<- as.Date(Manejo$S_ini[which(ID$UC=="Cautario")], format="%d/%m/%Y") tab_c \<- table(cut(dat_cautario, 'month'))

dat_rop \<- as.Date(Manejo$S_ini[which(ID$UC=="ROP")], format="%d/%m/%Y") tab_r \<- table(cut(dat_rop, 'month'))

dat_rop \<- as.Date(Manejo$S_ini[which(ID$UC=="Lago_Cuina")], format="%d/%m/%Y") tab_l \<- table(cut(dat_rop, 'month'))

plot(tab_c, col="black", type = "l",lty=3, ylab="Frequencia", xlab="Datas", ylim=c(0,5), main="Época de sangramento") lines(tab_r, col="red",type = "l" , lty=2) lines(tab_l, col="green",type = "l" , lty=4)

legend(3,5, legend=c("Cautario", "ROP", "Lago Cuinã"), lty=c(3,2,4),col=c("black", "red", "green"), )

par(mfrow=c(1, 1)) \### Mudas counts=table(Manejo$Mudas,ID$UC) counts=prop.table(counts,2)\*100 barplot(counts, main="Há novas mudas?", xlab="Unidades de Conservação", col=c("Black","Gray"), legend = rownames(counts), ylim = c(0,100), ylab = "Frequencia")

#### Castanheira morreu

counts=table(Manejo$Cas_morreu,ID$UC) counts=prop.table(counts,2)\*100 barplot(counts, main="Castanheira morreu?", xlab="Unidades de Conservação", col=c("Black","Gray"), legend = rownames(counts), ylim = c(0,100), ylab = "Porcentagem")

#### Quantas morreram

boxplot(Manejo$Cas_morreu_q~ID$UC, main="Média de castanheiras mortas", ylab = "Média de árvores que morreram", xlab = "Unidade de Conservação")

##por castanhal

barplot(Manejo$Cas_morreu_q~ID$ID, cex.lab=1.5, main="Quantidade de castanhas que morreram", cex.main=1.5, ylab = "Total", xlab = "Castanhais")

text(4,6.8, "Cautario") text(18,6.800, "Rio Ouro") text(18,6.000, "Preto") text(28,6.800, "Cuinã") text(41,6.800, "Cazumbá") abline(v=12) abline(v=23.8) abline(v=34.8)

#### Razão da morte

par(mfrow=c(1, 1)) par(mar=c(9,5,5,5)) plot(Manejo\$Cas_morreu_c,las=2,main="Razão da morte", ylab="Frequencia" )
